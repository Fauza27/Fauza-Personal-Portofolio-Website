---
title: "10 Next.js Performance Tips for Production"
date: "2024-01-20"
excerpt: "Practical tips to optimize your Next.js application for production, from image optimization to caching strategies."
author: "Muhammad Fauza"
tags: ["Next.js", "Performance", "Web Development"]
readTime: "6 min read"
---

## Introduction

Next.js is fast out of the box, but there's always room for optimization. Here are 10 practical tips I use in production to squeeze every bit of performance from Next.js applications.

## 1. Use Next/Image Properly

The Image component is powerful, but you need to use it correctly:

```tsx
import Image from 'next/image';

// ✅ Good: Specify dimensions
<Image
  src="/hero.jpg"
  width={1200}
  height={600}
  alt="Hero"
  priority // for above-the-fold images
/>

// ❌ Bad: Using fill without container
<Image src="/hero.jpg" fill alt="Hero" />
```

**Pro tip**: Use `priority` for above-the-fold images and `loading="lazy"` for everything else.

## 2. Implement Proper Caching

Use revalidation strategies wisely:

```tsx
// Static with revalidation
export const revalidate = 3600; // 1 hour

// Or per-request
export async function generateStaticParams() {
  return [{ slug: 'post-1' }, { slug: 'post-2' }];
}
```

## 3. Optimize Fonts

Use next/font for automatic font optimization:

```tsx
import { Inter } from 'next/font/google';

const inter = Inter({
  subsets: ['latin'],
  display: 'swap',
  variable: '--font-inter',
});
```

## 4. Code Splitting with Dynamic Imports

Lazy load heavy components:

```tsx
import dynamic from 'next/dynamic';

const HeavyComponent = dynamic(() => import('./HeavyComponent'), {
  loading: () => <Skeleton />,
  ssr: false, // if not needed on server
});
```

## 5. Use Server Components by Default

In App Router, components are Server Components by default. Only use 'use client' when necessary:

```tsx
// ✅ Server Component (default)
async function BlogPost({ id }) {
  const post = await getPost(id);
  return <article>{post.content}</article>;
}

// ✅ Client Component (when needed)
'use client';
function InteractiveWidget() {
  const [count, setCount] = useState(0);
  return <button onClick={() => setCount(count + 1)}>{count}</button>;
}
```

## 6. Optimize Database Queries

Use Prisma or similar ORMs efficiently:

```tsx
// ❌ Bad: N+1 query problem
const posts = await prisma.post.findMany();
for (const post of posts) {
  const author = await prisma.user.findUnique({ where: { id: post.authorId } });
}

// ✅ Good: Include relations
const posts = await prisma.post.findMany({
  include: { author: true },
});
```

## 7. Implement Streaming

Use Suspense for progressive rendering:

```tsx
import { Suspense } from 'react';

export default function Page() {
  return (
    <>
      <Header />
      <Suspense fallback={<Skeleton />}>
        <SlowComponent />
      </Suspense>
      <Footer />
    </>
  );
}
```

## 8. Optimize Bundle Size

Analyze and reduce your bundle:

```bash
npm run build
# Check .next/analyze/

# Use bundle analyzer
npm install @next/bundle-analyzer
```

```js
// next.config.js
const withBundleAnalyzer = require('@next/bundle-analyzer')({
  enabled: process.env.ANALYZE === 'true',
});

module.exports = withBundleAnalyzer({
  // config
});
```

## 9. Use Middleware Wisely

Keep middleware fast and focused:

```tsx
// middleware.ts
import { NextResponse } from 'next/server';

export function middleware(request) {
  // Fast checks only
  const token = request.cookies.get('token');
  if (!token) {
    return NextResponse.redirect(new URL('/login', request.url));
  }
}

export const config = {
  matcher: ['/dashboard/:path*'],
};
```

## 10. Monitor Performance

Use built-in analytics:

```tsx
// app/layout.tsx
import { SpeedInsights } from '@vercel/speed-insights/next';
import { Analytics } from '@vercel/analytics/react';

export default function RootLayout({ children }) {
  return (
    <html>
      <body>
        {children}
        <SpeedInsights />
        <Analytics />
      </body>
    </html>
  );
}
```

## Bonus: Edge Runtime

For ultra-fast responses, use Edge Runtime:

```tsx
export const runtime = 'edge';

export async function GET() {
  return Response.json({ message: 'Hello from the edge!' });
}
```

## Conclusion

Performance optimization is an ongoing process. Start with these tips, measure the impact, and iterate. Remember: premature optimization is the root of all evil, but informed optimization is the path to success.

## Resources

- [Next.js Performance Docs](https://nextjs.org/docs/app/building-your-application/optimizing)
- [Web Vitals](https://web.dev/vitals/)
- [Vercel Analytics](https://vercel.com/analytics)
